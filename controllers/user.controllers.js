"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.updateUser=exports.deleteUser=exports.createUser=exports.getAllUsers=exports.viewUsers=void 0;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator")),_User=_interopRequireDefault(require("../models/User")),_bcryptjs=_interopRequireDefault(require("bcryptjs"));function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){(0,_defineProperty2["default"])(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}var viewUsers=function(a,b){b.send("respond with a resource")};exports.viewUsers=viewUsers;var getAllUsers=/*#__PURE__*/function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c){var d;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,_User["default"].find({state:!0});case 3:d=a.sent,c.status(200).json({allUsers:d,count:d.length}),a.next=10;break;case 7:a.prev=7,a.t0=a["catch"](0),c.status(500).json({message:a.t0.message,err:a.t0});case 10:case"end":return a.stop();}},a,null,[[0,7]])}));return function(){return a.apply(this,arguments)}}();exports.getAllUsers=getAllUsers;var createUser=function(a,b){var c=a.body,d=c.password;_bcryptjs["default"].hash(d,10,/*#__PURE__*/function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(d,e){var f;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!d){a.next=2;break}return a.abrupt("return",b.status(500).json({message:d.message,err:d}));case 2:return a.prev=2,a.next=5,_User["default"].create(_objectSpread(_objectSpread({},c),{},{password:e}));case 5:f=a.sent,f.password="...",b.status(201).json({message:"Se creo el usuario",_user:f}),a.next=13;break;case 10:a.prev=10,a.t0=a["catch"](2),b.status(500).json({message:a.t0.message,err:a.t0});case 13:case"end":return a.stop();}},a,null,[[2,10]])}));return function(){return a.apply(this,arguments)}}())};exports.createUser=createUser;var deleteUser=/*#__PURE__*/function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c){var d,e;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.params.id,a.next=3,_User["default"].findByIdAndDelete(d);case 3:e=a.sent,c.status(201).json({message:"Usuario eliminado",_user:e});case 5:case"end":return a.stop();}},a)}));return function(){return a.apply(this,arguments)}}();exports.deleteUser=deleteUser;var updateUser=/*#__PURE__*/function(){var a=(0,_asyncToGenerator2["default"])(/*#__PURE__*/_regenerator["default"].mark(function a(b,c){var d,e;return _regenerator["default"].wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!b.body.password){a.next=2;break}return a.abrupt("return",c.status(404).json({error:"Unauthorized"}));case 2:return d=b.params.id,a.next=5,_User["default"].findByIdAndUpdate(d,b.body,{new:!0});case 5:e=a.sent,c.status(201).json({message:"Usuario actualizado",_user:e});case 7:case"end":return a.stop();}},a)}));return function(){return a.apply(this,arguments)}}();exports.updateUser=updateUser;