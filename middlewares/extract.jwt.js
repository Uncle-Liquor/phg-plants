"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.extractJWT=void 0;var _logging=require("../config/logging"),_config=_interopRequireDefault(require("../config/config")),_jsonwebtoken=_interopRequireDefault(require("jsonwebtoken")),NAMESPACE="Auth",extractJWT=function(a,b,c){var d;(0,_logging.info)(NAMESPACE,"Token validated, user authorized");var e=null===(d=a.headers.authorization)||void 0===d?void 0:d.split(" ")[1];return e?void _jsonwebtoken["default"].verify(e,_config["default"].TOKEN_SECRET,function(a,d){return a?b.status(404).json({message:a.message,error:a}):void(b.locals.jwt=d,c())}):b.status(401).json({message:"Unauthorized"})};exports.extractJWT=extractJWT;